# 《分子动力学模拟》第5章：线性标度的分子动力学模拟程序


## 本章程序

见 `src/linearMD.cpp`

## 本章范例

![neighbor](src/examples/fig-chapter5-neighbor.png)

用本章的程序 `linearMD.cpp` 进行测试，得到如上图的结果。
此图对比了三种近邻列表方案下程序跑 1000 步所花的时间和体系原子数的关系。
这里的三种近邻列表方案分别是：
- 不使用近邻列表（类似于上一章的程序，但注意我们从本章开始使用了三斜的盒子）；
- 使用 $\mathcal{O}(N^2)$ 计算复杂度的近邻列表构建方法；
- 使用 $\mathcal{O}(N)$ 计算复杂度的近邻列表构建方法。

该图的结果是符合预期了，它展示了如下特征：
- 不使用近邻列表时，程序的计算量正比于原子数的平方，拥有典型的 $\mathcal{O}(N^2)$ 计算复杂度。
- 使用 $\mathcal{O}(N^2)$ 计算复杂度的近邻列表构建方法时，程序的计算量在小体系的极限下正比于原子数，但在大体系的极限下正比于原子数平方。
- 使用 $\mathcal{O}(N)$ 计算复杂度的近邻列表构建方法时，程序的计算量始终正比于原子数，具有 $\mathcal{O}(N)$ 复杂度。
所以，在研究较大体系时，一定要采用 $\mathcal{O}(N)$ 计算复杂度的近邻列表构建方法。
